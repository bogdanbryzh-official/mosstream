const DateTime = luxon.DateTime,
  finishUTC = DateTime.utc(2020, 12, 24, 12, 0),
  nowUTC = DateTime.utc(),
  DAY = 1440,
  HOUR = 60,
  finish = {
    days: finishUTC.day,
    hours: finishUTC.hour,
    minutes: finishUTC.minute,
  },
  now = { days: nowUTC.day, hours: nowUTC.hour, minutes: nowUTC.minute },
  finishTime = 24 * finish.days * 60 + 60 * finish.hours + finish.minutes,
  nowTime = 24 * now.days * 60 + 60 * now.hours + now.minutes,
  differenceTime = finishTime - nowTime,
  days = Math.floor(differenceTime / DAY),
  hours = Math.floor((differenceTime - days * DAY) / 60),
  minutes = differenceTime - days * DAY - 60 * hours,
  difference = { days: days, hours: hours, minutes: minutes },
  showStream = () => {
    document.getElementById('timer').remove()
    const e = document.getElementById('stream')
    ;(e.innerHTML +=
      '<script src="https://facecast.net/v/js/iframe.js"></script>'),
      e.getElementsByTagName('script')[0].addEventListener('load', () => {
        e.innerHTML += `<iframe id="b8mned" onload="fc_load_iframe(this)" style="border: none" width="100%" height="600" allow="autoplay; fullscreen" allowfullscreen></iframe>`
      })
  },
  flashDays = () => {
    const e = document.getElementById('days').getElementsByTagName('p')[0],
      t = document.getElementById('days').getElementsByTagName('p')[1],
      n = difference.days
    ;(e.textContent = n),
      1 == n && (t.textContent = 'ДЕНЬ'),
      n > 1 && n < 5 && (t.textContent = 'ДНЯ'),
      n > 5 && (t.textContent = 'ДНЕЙ')
  },
  flashHours = () => {
    const e = document.getElementById('hours').getElementsByTagName('p')[0],
      t = document.getElementById('hours').getElementsByTagName('p')[1],
      n = difference.hours
    ;(e.textContent = n),
      (t.textContent =
        1 == n || 21 == n
          ? 'ЧАС'
          : (n > 1 && n < 5) || n > 21
          ? 'ЧАСА'
          : 'ЧАСОВ')
  },
  flashMinutes = () => {
    const e = document.getElementById('minutes').getElementsByTagName('p')[0],
      t = document.getElementById('minutes').getElementsByTagName('p')[1],
      n = difference.minutes
    ;(e.textContent = n),
      (t.textContent =
        1 == n || 21 == n || 31 == n || 41 == n || 51 == n
          ? 'МИНУТУ'
          : (n > 1 && n < 5) ||
            (n > 21 && n < 25) ||
            (n > 31 && n < 35) ||
            (n > 41 && n < 45) ||
            (n > 51 && n < 55)
          ? 'МИНУТЫ'
          : 'МИНУТ')
  },
  count = () => {
    differenceTime <= 0
      ? (clearInterval(timer), showStream())
      : (flashDays(), flashHours(), flashMinutes())
  },
  timer = setInterval(count, 1e3)
count()
